#if !defined(_FUNCTIONS_GRAY_HPP_)
#define _FUNCTIONS_GRAY_HPP_

#include <irafldef.h>
#include "functions.hpp"
#include <cstdint>
#include <string>

namespace IRAFLFunc
{
    namespace name
    {
        static std::string GrayName = "gray";
    }
    namespace gray
    {
        static unsigned int GrayB_114[256] = {
            0, 114, 228, 342, 456, 570, 684, 798, 912, 1026, 1140, 1254, 1368, 1482, 1596, 1710,
            1824, 1938, 2052, 2166, 2280, 2394, 2508, 2622, 2736, 2850, 2964, 3078, 3192, 3306, 3420, 3534,
            3648, 3762, 3876, 3990, 4104, 4218, 4332, 4446, 4560, 4674, 4788, 4902, 5016, 5130, 5244, 5358,
            5472, 5586, 5700, 5814, 5928, 6042, 6156, 6270, 6384, 6498, 6612, 6726, 6840, 6954, 7068, 7182,
            7296, 7410, 7524, 7638, 7752, 7866, 7980, 8094, 8208, 8322, 8436, 8550, 8664, 8778, 8892, 9006,
            9120, 9234, 9348, 9462, 9576, 9690, 9804, 9918, 10032, 10146, 10260, 10374, 10488, 10602, 10716, 10830,
            10944, 11058, 11172, 11286, 11400, 11514, 11628, 11742, 11856, 11970, 12084, 12198, 12312, 12426, 12540, 12654,
            12768, 12882, 12996, 13110, 13224, 13338, 13452, 13566, 13680, 13794, 13908, 14022, 14136, 14250, 14364, 14478,
            14592, 14706, 14820, 14934, 15048, 15162, 15276, 15390, 15504, 15618, 15732, 15846, 15960, 16074, 16188, 16302,
            16416, 16530, 16644, 16758, 16872, 16986, 17100, 17214, 17328, 17442, 17556, 17670, 17784, 17898, 18012, 18126,
            18240, 18354, 18468, 18582, 18696, 18810, 18924, 19038, 19152, 19266, 19380, 19494, 19608, 19722, 19836, 19950,
            20064, 20178, 20292, 20406, 20520, 20634, 20748, 20862, 20976, 21090, 21204, 21318, 21432, 21546, 21660, 21774,
            21888, 22002, 22116, 22230, 22344, 22458, 22572, 22686, 22800, 22914, 23028, 23142, 23256, 23370, 23484, 23598,
            23712, 23826, 23940, 24054, 24168, 24282, 24396, 24510, 24624, 24738, 24852, 24966, 25080, 25194, 25308, 25422,
            25536, 25650, 25764, 25878, 25992, 26106, 26220, 26334, 26448, 26562, 26676, 26790, 26904, 27018, 27132, 27246,
            27360, 27474, 27588, 27702, 27816, 27930, 28044, 28158, 28272, 28386, 28500, 28614, 28728, 28842, 28956, 29070,
        };
        static unsigned int GrayG_587[256] = {
            0, 587, 1174, 1761, 2348, 2935, 3522, 4109, 4696, 5283, 5870, 6457, 7044, 7631, 8218, 8805,
            9392, 9979, 10566, 11153, 11740, 12327, 12914, 13501, 14088, 14675, 15262, 15849, 16436, 17023, 17610, 18197,
            18784, 19371, 19958, 20545, 21132, 21719, 22306, 22893, 23480, 24067, 24654, 25241, 25828, 26415, 27002, 27589,
            28176, 28763, 29350, 29937, 30524, 31111, 31698, 32285, 32872, 33459, 34046, 34633, 35220, 35807, 36394, 36981,
            37568, 38155, 38742, 39329, 39916, 40503, 41090, 41677, 42264, 42851, 43438, 44025, 44612, 45199, 45786, 46373,
            46960, 47547, 48134, 48721, 49308, 49895, 50482, 51069, 51656, 52243, 52830, 53417, 54004, 54591, 55178, 55765,
            56352, 56939, 57526, 58113, 58700, 59287, 59874, 60461, 61048, 61635, 62222, 62809, 63396, 63983, 64570, 65157,
            65744, 66331, 66918, 67505, 68092, 68679, 69266, 69853, 70440, 71027, 71614, 72201, 72788, 73375, 73962, 74549,
            75136, 75723, 76310, 76897, 77484, 78071, 78658, 79245, 79832, 80419, 81006, 81593, 82180, 82767, 83354, 83941,
            84528, 85115, 85702, 86289, 86876, 87463, 88050, 88637, 89224, 89811, 90398, 90985, 91572, 92159, 92746, 93333,
            93920, 94507, 95094, 95681, 96268, 96855, 97442, 98029, 98616, 99203, 99790, 100377, 100964, 101551, 102138, 102725,
            103312, 103899, 104486, 105073, 105660, 106247, 106834, 107421, 108008, 108595, 109182, 109769, 110356, 110943, 111530, 112117,
            112704, 113291, 113878, 114465, 115052, 115639, 116226, 116813, 117400, 117987, 118574, 119161, 119748, 120335, 120922, 121509,
            122096, 122683, 123270, 123857, 124444, 125031, 125618, 126205, 126792, 127379, 127966, 128553, 129140, 129727, 130314, 130901,
            131488, 132075, 132662, 133249, 133836, 134423, 135010, 135597, 136184, 136771, 137358, 137945, 138532, 139119, 139706, 140293,
            140880, 141467, 142054, 142641, 143228, 143815, 144402, 144989, 145576, 146163, 146750, 147337, 147924, 148511, 149098, 149685,
        };
        static unsigned int GrayR_299[256] = {
            0, 299, 598, 897, 1196, 1495, 1794, 2093, 2392, 2691, 2990, 3289, 3588, 3887, 4186, 4485,
            4784, 5083, 5382, 5681, 5980, 6279, 6578, 6877, 7176, 7475, 7774, 8073, 8372, 8671, 8970, 9269,
            9568, 9867, 10166, 10465, 10764, 11063, 11362, 11661, 11960, 12259, 12558, 12857, 13156, 13455, 13754, 14053,
            14352, 14651, 14950, 15249, 15548, 15847, 16146, 16445, 16744, 17043, 17342, 17641, 17940, 18239, 18538, 18837,
            19136, 19435, 19734, 20033, 20332, 20631, 20930, 21229, 21528, 21827, 22126, 22425, 22724, 23023, 23322, 23621,
            23920, 24219, 24518, 24817, 25116, 25415, 25714, 26013, 26312, 26611, 26910, 27209, 27508, 27807, 28106, 28405,
            28704, 29003, 29302, 29601, 29900, 30199, 30498, 30797, 31096, 31395, 31694, 31993, 32292, 32591, 32890, 33189,
            33488, 33787, 34086, 34385, 34684, 34983, 35282, 35581, 35880, 36179, 36478, 36777, 37076, 37375, 37674, 37973,
            38272, 38571, 38870, 39169, 39468, 39767, 40066, 40365, 40664, 40963, 41262, 41561, 41860, 42159, 42458, 42757,
            43056, 43355, 43654, 43953, 44252, 44551, 44850, 45149, 45448, 45747, 46046, 46345, 46644, 46943, 47242, 47541,
            47840, 48139, 48438, 48737, 49036, 49335, 49634, 49933, 50232, 50531, 50830, 51129, 51428, 51727, 52026, 52325,
            52624, 52923, 53222, 53521, 53820, 54119, 54418, 54717, 55016, 55315, 55614, 55913, 56212, 56511, 56810, 57109,
            57408, 57707, 58006, 58305, 58604, 58903, 59202, 59501, 59800, 60099, 60398, 60697, 60996, 61295, 61594, 61893,
            62192, 62491, 62790, 63089, 63388, 63687, 63986, 64285, 64584, 64883, 65182, 65481, 65780, 66079, 66378, 66677,
            66976, 67275, 67574, 67873, 68172, 68471, 68770, 69069, 69368, 69667, 69966, 70265, 70564, 70863, 71162, 71461,
            71760, 72059, 72358, 72657, 72956, 73255, 73554, 73853, 74152, 74451, 74750, 75049, 75348, 75647, 75946, 76245,
        };
        void IRAFL_LOCAL gray(unsigned char*& dst, const unsigned char* src, const long& w, const long& h, const void* params)
        {
            params;
            for (long j = 0; j < h; j++)
                for (long i = 0; i < w; i++)
                {
                    unsigned char b = src[(j * w + i) * 4 + 0];
                    unsigned char g = src[(j * w + i) * 4 + 1];
                    unsigned char r = src[(j * w + i) * 4 + 2];
                    unsigned char gray = (unsigned char)((GrayB_114[b] + GrayG_587[g] + GrayR_299[r]) / 1000.0f + 0.5f);
                    dst[(j * w + i) * 4 + 0] = gray;
                    dst[(j * w + i) * 4 + 1] = gray;
                    dst[(j * w + i) * 4 + 2] = gray;
                    dst[(j * w + i) * 4 + 3] = src[(j * w + i) * 4 + 3];
                }
        }
    }
}

#endif
